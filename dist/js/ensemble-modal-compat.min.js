!function(t,e){if("function"==typeof define&&define.amd)define(["exports"],e);else if("undefined"!=typeof exports)e(exports);else{var n={exports:{}};e(n.exports),t.ensemble=n.exports}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,(function(t){"use strict";
/*!
   * loltgt ensemble.Compo
   *
   * @version 0.0.1
   * @copyright Copyright (C) Leonardo Laureti
   * @license MIT License
   */function e(t,n){return(e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,n)}function n(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=o(t);if(e){var s=o(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return i(this,n)}}function i(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e,n,i,o,r,s){try{var u=t[r](s),a=u.value}catch(t){return void n(t)}u.done?e(a):Promise.resolve(a).then(i,o)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(i,o){var s=t.apply(e,n);function u(t){r(s,i,o,u,a,"next",t)}function a(t){r(s,i,o,u,a,"throw",t)}u(void 0)}))}}function u(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,r=t},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw r}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function f(t,e,n){return e&&h(t.prototype,e),n&&h(t,n),t}Object.defineProperty(t,"__esModule",{value:!0}),t.Modal=void 0;var d=/html|head|body|meta|link|style|script/i,p=/(<(html|head|body|meta|link|style|script)*>)/i,v=/attributes|classList|innerHTML|outerHTML|nodeName|nodeType/,y=function(){function t(e,n,i,o){if(c(this,t),!(this instanceof t?this.constructor:void 0))throw"ensemble error: Wrong invocation, must be called with new.";var r=this._ns="_"+e,s=i?n.toString():"div";if(d.test(s))throw new Error("ensemble.Compo error: The tag name provided ('".concat(s,"') is not a valid name."));var a=this[r]=document.createElement(s);if(this[r].__compo=this,o&&"object"==l(o))for(var h in o){var f=h.toString();if(v.test(f))throw new Error("ensemble.Compo error: The property name provided ('".concat(f,"')' is not a valid name."));if(0===f.indexOf("on")&&o[f])a[f]=o[f].bind(this);else if("object"!=l(o[f]))a[f]=o[f];else if("children"===f&&"object"==l(o[f])&&o[f].length){var p,y=u(o.children);try{for(y.s();!(p=y.n()).done;){var m=p.value,b=m.tag,k=m.name,g=m.props;this.append(new t(e,b,k,g))}}catch(t){y.e(t)}finally{y.f()}}}if(0!=i&&1!=i){var w=a.className;a.className=e+"-"+n,i&&(a.className+=" "+e+"-"+i),w&&(a.className+=" "+w)}}return f(t,[{key:"install",value:function(t){t.appendChild(this[this._ns])}},{key:"uninstall",value:function(t){t.removeChild(this[this._ns])}},{key:"up",value:function(t){return this.node=Object.seal({ref:t}),!!t.replaceWith(this[this._ns])}},{key:"append",value:function(t){var e=this._ns;return!!this[e].appendChild(t[e])}},{key:"prepend",value:function(t){var e=this._ns;return!!this[e].prependChild(t[e])}},{key:"remove",value:function(t){var e=this._ns;return!!this[e].removeChild(t[e])}},{key:"replace",value:function(t){}},{key:"clone",value:function(){}},{key:"inject",value:function(t){if(t instanceof Element==!1||d.test(t.tagName)||p.test(t.innerHTML))throw new Error("ensemble.Compo error: The remote object could not be resolved into a valid node.");this.empty(),this._node=this[this._ns].appendChild(t)}},{key:"empty",value:function(){for(;this.first;)this.remove(this.first)}},{key:"hasAttr",value:function(t){return this[this._ns].hasAttribute(t)}},{key:"getAttr",value:function(t){return this[this._ns].getAttribute(t)}},{key:"setAttr",value:function(t,e){this[this._ns].setAttribute(t,e)}},{key:"delAttr",value:function(t){this[this._ns].removeAttribute(t)}},{key:"getStyle",value:function(t){return window.getComputedStyle(this[this._ns])[t]}},{key:"show",value:function(){this[this._ns].hidden=!1}},{key:"hide",value:function(){this[this._ns].hidden=!0}},{key:"enable",value:function(){this[this._ns].disabled=!1}},{key:"disable",value:function(){this[this._ns].disabled=!0}},{key:"children",get:function(){return Array.prototype.map.call(this[this._ns].children,(function(t){return t.__compo}))}},{key:"first",get:function(){var t=this._ns;return this[t].firstElementChild?this[t].firstElementChild.__compo:null}},{key:"last",get:function(){var t=this._ns;return this[t].lastElementChild?this[t].lastElementChild.__compo:null}},{key:"previous",get:function(){var t=this._ns;return this[t].previousElementSibling?this[t].previousElementSibling.__compo:null}},{key:"next",get:function(){var t=this._ns;return this[t].nextElementSibling?this[t].nextElementSibling.__compo:null}},{key:"classList",get:function(){return this[this._ns].classList}},{key:Symbol.toStringTag,get:function(){return"ensemble.Compo"}}],[{key:"isCompo",value:function(e){return Symbol.for(e)===Symbol.for(t.prototype)}}]),t}(),m=function(){function t(e,n){if(c(this,t),!(this instanceof t?this.constructor:void 0))throw"ensemble error: Wrong invocation, must be called with new.";n&&"object"===l(n)&&Object.assign(this,{},n),this[this._ns="_"+e]={ns:e}}var e,n,i;return f(t,[{key:"compo",value:function(t,e,n){var i,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=this[this._ns].ns;return i=o?{ns:u,tag:t,name:e,props:n,fresh:r,stale:s}:new y(u,t,e,n),r&&"function"==typeof r&&(i.fresh=n.onfresh=r),s&&"function"==typeof s&&(i.stale=n.onstale=s),i}},{key:"render",value:(i=s(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this[n=this._ns][e]&&this[n][e].rendered||(this[n][e]={rendered:!0,fresh:this[e].fresh,stale:this[e].stale,params:this[e]},this[e]=new y(this[e].ns,this[e].tag,this[e].name,this[e].props)),this[n][e].fresh();case 2:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"stale",value:(n=s(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this[n=this._ns][e]&&this[n][e].rendered&&this[n][e].stale();case 2:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"reflow",value:(e=s(regeneratorRuntime.mark((function t(e,n){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=this._ns,n?this[i][e]=this.compo(this[i][e].params.ns,this[i][e].params.name,this[i][e].params.props):this[i][e]&&this[i][e].rendered&&this[i][e].fresh();case 2:case"end":return t.stop()}}),t,this)}))),function(t,n){return e.apply(this,arguments)})},{key:Symbol.toStringTag,get:function(){return"ensemble.Data"}}],[{key:"isData",value:function(e){return Symbol.for(e)===Symbol.for(t.prototype)}}]),t}(),b=function(){function t(e,n,i){if(c(this,t),!(this instanceof t?this.constructor:void 0))throw"ensemble error: Wrong invocation, must be called with new.";var o=this._ns="_"+e;i=(y.isCompo(i)?i.node:i)||document,this[o]={name:n,node:i}}return f(t,[{key:"add",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this[this._ns].node.addEventListener(this[this._ns].name,t,e)}},{key:"remove",value:function(t){this[this._ns].node.removeEventListener(this[this._ns].name,t)}},{key:Symbol.toStringTag,get:function(){return"ensemble.Event"}}],[{key:"isEvent",value:function(e){return Symbol.for(e)===Symbol.for(t.prototype)}}]),t}(),k=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&e(t,n)}(o,t);var i=n(o);function o(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c(this,o),(e=i.call(this))._bindings(),e.options=e.defaults(e._defaults(),n),Object.freeze(e.options),e.element=t,e}return f(o,[{key:"_defaults",value:function(){return{ns:"modal",root:"body",fx:!0,windowed:!1,cloning:!0,backClose:!1,keyboard:!0,close:{onclick:this.close,innerText:"Ã—",ariaLabel:"Close"},onOpen:function(){},onClose:function(){},onShow:function(){},onHide:function(){},onContent:function(){}}}},{key:"_bindings",value:function(){this.open=this.binds(this.open),this.close=this.binds(this.close),this.backx=this.binds(this.backx),this.keyboard=this.binds(this.keyboard)}},{key:"generator",value:function(){var t=this.options,e=this.box=this.compo("dialog",!0,{className:t.ns,hidden:!0,ariaModal:!0,role:"dialog",onclick:t.backClose?this.backx:null}),n=this.cnt=this.compo("content"),i=this.compo("button","close",t.close);return e.append(n),t.windowed?(e.classList.add(t.ns+"-windowed"),n.append(i)):e.append(i),t.fx&&e.classList.add(t.ns+"-fx"),this.root=this.selector(t.root),this.built=!0,e}},{key:"populate",value:function(t){var e=this.content(this.element);this.cnt.append(e)}},{key:"resume",value:function(t){console.log("resume",t)}},{key:"content",value:function(t,e){var n=this.options,i=this.compo("object"),o=(e=void 0!==e?e:n.cloning)?this.cloneNode(t,!0):t;return n.onContent.call(this,this,i,o),o&&i.inject(o),i}},{key:"destroy",value:function(){this.box.remove(),this.built=!1}},{key:"open",value:function(t,e){if(this.event(t),!this.opened){var n=this.options;this.built?this.resume(e):(this.generator(),this.populate(e)),this.opened=!0,n.onOpen.call(this,this,e,t),this.show(e),n.keyboard&&this.event("keydown").add(this.keyboard),console.log("open",this)}}},{key:"close",value:function(t,e){if(this.event(t),this.opened){var n=this.options;this.opened=!1,n.onClose.call(this,this,e,t),this.hide(e),n.keyboard&&this.event("keydown").remove(this.keyboard),console.log("close",this)}}},{key:"show",value:function(t){var e=this.options,n=this.root,i=this.box;i.install(n),this.delay((function(){i.show(),e.onShow.call(self,self,t)}))}},{key:"hide",value:function(t){var e=this.options,n=this.root,i=this.box;i.hide(),this.delay((function(){i.uninstall(n),e.onHide.call(self,self,t)}),i,300)}},{key:"backx",value:function(t){this.event(t),t.target!=this.box&&t.target!=this.cnt||this.close(t)}},{key:"keyboard",value:function(t){this.event(t),27===(t.keyCode||0)&&this.close(t)}}]),o}(function(){function t(){if(c(this,t),!(this instanceof t?this.constructor:void 0))throw"ensemble error: Wrong invocation, must be called with new."}return f(t,[{key:"defaults",value:function(t,e){var n={};for(var i in t)null!=t[i]&&"object"===l(t[i])?n[i]=Object.assign(t[i],e[i]):n[i]=void 0!==e[i]?e[i]:t[i];return n}},{key:"compo",value:function(t,e,n){return new y(this.options.ns,t,e,n)}},{key:"data",value:function(t){return new m(this.options.ns,t)}},{key:"event",value:function(t,e){if("string"==typeof t)return new b(this.options.ns,t,e);t&&(t.preventDefault(),t.target.blur())}},{key:"selector",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e=e||document,n?e.querySelectorAll(t):e.querySelector(t)}},{key:"appendNode",value:function(t,e){return!!t.appendChild(e)}},{key:"prependNode",value:function(t,e){return!!t.prependChild(e)}},{key:"removeNode",value:function(t,e){return!!t.removeChild(e)}},{key:"cloneNode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.cloneNode(e)}},{key:"hasAttr",value:function(t,e){return t.hasAttribute(e)}},{key:"getAttr",value:function(t,e){return t.getAttribute(e)}},{key:"setAttr",value:function(t,e,n){t.setAttribute(e,n)}},{key:"delAttr",value:function(t,e){t.removeAttribute(e)}},{key:"binds",value:function(t){var e=this;return function(n){t.call(e,n,this)}}},{key:"delay",value:function(t,e,n){var i=e?this.timing(e):0;setTimeout(t,i||n)}},{key:"timing",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"transitionDuration",n=y.isCompo(t)?t.getStyle(e):window.getComputedStyle(t)[e];return n&&(n=n.indexOf("s")?1e3*parseFloat(n):parseInt(n)),n||0}}]),t}());t.Modal=k}));
//# sourceMappingURL=ensemble-modal-compat.min.js.map
