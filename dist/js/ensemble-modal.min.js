/*!
 * ensemble Modal
 * @version 0.4.0
 * @link https://github.com/loltgt/ensemble-modal
 * @copyright Copyright (C) Leonardo Laureti
 * @license MIT License
 */
!function(t){"use strict";const e=new Proxy({},{get:(t,e)=>t.lang&&t[t.lang][e]||e}),s="html|head|body|meta|link|style|script";class part{render(){delete this.element,delete this.render}bind(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.appendChild(s)}unbind(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.removeChild(s)}place(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.replaceWith(s)}append(t){const e=this.ns;return!!this[e].appendChild(t[e])}prepend(t){const e=this.ns,s=this[e];return!!s.insertBefore(t[e],s.firstElementChild||null)}remove(t){const e=this.ns;return!!this[e].removeChild(t[e])}fill(t){if(!t instanceof Element||RegExp(s,"i").test(t.tagName)||RegExp(`(<(${s})*>)`,"i").test(t.innerHTML))throw new Error(e.EMTAG);return this.empty(),!!this[this.ns].appendChild(t)}empty(){for(;this.first;)this.remove(this.first)}get children(){return Array.prototype.map.call(this[this.ns].children,(t=>t._1))}get first(){const t=this[this.ns];return t.firstElementChild?t.firstElementChild._1:null}get last(){const t=this[this.ns];return t.lastElementChild?t.lastElementChild._1:null}}class Compo extends part{constructor(t,n,o,i,r,l){super();const c=this.ns=`_${t}`,h=n?n.toString():"div";if(RegExp(s,"i").test(h))throw new Error(e.ETAGN);const a=this[c]=this.element(t,h,o,i,r,l);if(this.__Compo=1,this[c]._1=this,i&&"object"==typeof i)for(const s in i){const n=s.toString();if(RegExp("attributes|classList|innerHTML|outerHTML|nodeName|nodeType").test(n))throw new Error(e.EPROP);if(0===n.indexOf("on")&&i[n]&&"function"==typeof i[n])a[n]=i[n].bind(this);else if("object"!=typeof i[n])a[n]=i[n];else if("children"==n&&"object"==typeof i[n]&&i[n].length)for(const e of i.children){const{tag:s,name:n,props:o}=e;this.append(new Compo(t,s,n,o))}}if(o){const e=a.className;a.className="","string"==typeof o?a.className=`${t}-${o}`:"object"==typeof o&&(a.className=Object.values(o).map((e=>`${t}-${e}`)).join(" ")),e&&(a.className+=` ${e}`)}this.render()}element(t,e,s,n,o,i){return i?document.createElementNS(i,e,o):document.createElement(e,o)}hasAttr(t){return this[this.ns].hasAttribute(t)}getAttr(t){return this[this.ns].getAttribute(t)}setAttr(t,e){this[this.ns].setAttribute(t,e)}delAttr(t){this[this.ns].removeAttribute(t)}getStyle(t){return getComputedStyle(this[this.ns])[t]}show(){this[this.ns].hidden=!1}hide(){this[this.ns].hidden=!0}enable(){this[this.ns].disabled=!1}disable(){this[this.ns].disabled=!0}get node(){return console.warn(e.DOM),this[this.ns]}get parent(){const t=this[this.ns];return t.parentElement&&t.parentElement._1?t.parentElement._1:null}get previous(){const t=this[this.ns];return t.previousElementSibling?t.previousElementSibling._1:null}get next(){const t=this[this.ns];return t.nextElementSibling?t.nextElementSibling._1:null}get classList(){return this[this.ns].classList}static isCompo(t){return t instanceof Compo}}class Data{constructor(t,e){e&&"object"==typeof e&&Object.assign(this,{},e);const s=this.ns=`_${t}`;this.__Data=0,this[s]={ns:t}}compo(t,e,s,n=!1,o=!1,i=!1){const r=this[this.ns].ns;let l;return l=n?{ns:r,tag:t,name:e,props:s,load:o,unload:i}:new Compo(r,t,e,s),o&&"function"==typeof o&&(l.load=s.onload=o),i&&"function"==typeof i&&(l.unload=s.onunload=i),l}async render(t){const e=this[this.ns],s=this;e[t]&&e[t]._||(e[t]={_:s[t],load:s[t].load,unload:s[t].unload},s[t]=new Compo(s[t].ns,s[t].tag,s[t].name,s[t].props)),e[t].load()}async unload(t){const e=this[this.ns];e[t]&&e[t]._&&e[t].unload()}async reflow(t,e){const s=this[this.ns];e?s[t]=this.compo(s[t]._.ns,s[t]._.name,s[t]._.props):s[t]&&s[t]._&&s[t].load()}static isData(t){return t instanceof Data}}class Event{constructor(t,e,s){const n=this.ns=`_${t}`;s=(Compo.isCompo(s)?s[t]:s)||document,this.__Event=0,this[n]={name:e,node:s}}add(t,e=!1){const{node:s,name:n}=this[this.ns];s.addEventListener(n,t,e)}remove(t){const{node:e,name:s}=this[this.ns];e.removeEventListener(s,t)}static prevent(t){t.preventDefault()}static focus(t,e){const{currentTarget:s}=t;s.focus&&s.focus(e)}static blur(t,e=100){const{currentTarget:s}=t;setTimeout((()=>s.blur&&s.blur()),e)}static isEvent(t){return t instanceof Event}}class base{constructor(){const t=arguments;let s,n;if(t.length>1?(s=t[0],n=t[1]):t[0]&&"object"==typeof t[0]&&t[0].nodeType?s=t[0]:n=t[0],n&&"object"!=typeof n)throw new TypeError(e.EOPTS);if(s&&"object"!=typeof s)throw new TypeError(e.EELEM);this.binds(),this.options=this.opts(this.defaults(),n),Object.freeze(this.options),this.element=s}opts(t,e={}){const s={};for(const n in t)null!=t[n]&&"object"==typeof t[n]?s[n]=Object.assign(t[n],e[n]):s[n]=void 0!==e[n]?e[n]:t[n];return s}compo(t,e,s){const n=this.options.ns;return null!=t?new Compo(n,t,e,s):Compo}data(t){const e=this.options.ns;return null!=t?new Data(e,t):Data}event(t,e){const s=this.options.ns;return null!=t?new Event(s,t,e):Event}selector(t,e,s=!1){return e=e||document,s?e.querySelectorAll(t):e.querySelector(t)}cloneNode(t,e=!1){return t.cloneNode(e)}hasAttr(t,e){return t.hasAttribute(e)}getAttr(t,e){return t.getAttribute(e)}icon(t,e,s,n,o,i){const r=this.options.ns,l=s?`${s}-${e}`:e,c=this.compo("span","icon",{className:l});if("font"!=t)if("symbol"==t||"shape"==t){const e="http://www.w3.org/2000/svg",s=new Compo(r,"svg",!1,!1,null,e),l="symbol"==t?"use":"path",h=new Compo(r,l,!1,!1,null,e);if(i){const t=i.match(/\d+ \d+ (\d+) (\d+)/);t&&Object.entries({width:t[1],height:t[2],viewBox:t[0]}).forEach((t=>s.setAttr(t[0],t[1])))}"use"==l?h.setAttr("href",`#${o}`):h.setAttr("d",n),s.append(h),c.append(s)}else if("svg"==t&&this.origin()){const t=this.compo(r,"img",!1,{src:`${n}#${o}`});c.append(t)}return c}origin(t,e){return e=URL.canParse(e)?e:"null"!=window.origin?window.origin:window.location.origin,t=URL.canParse(t)?new URL(t).origin:e,e&&t&&e===t}cst(t,e){let s=Compo.isCompo(t)?t.getStyle(e):getComputedStyle(t)[e];return s&&(s=s.indexOf("s")?1e3*parseFloat(s):parseInt(s)),s||0}delay(t,e,s){const n=e?this.cst(e,"transitionDuration"):0;setTimeout(t,n||s)}wrap(t){const s=this;if(this[t]&&"function"!=typeof t)throw new TypeError(e.EMETH);return function(){t.call(s,...arguments,this)}}}t.Modal=class Modal extends base{defaults(){return{ns:"modal",root:"body",className:"modal",dialog:!0,modal:!0,window:!1,icons:{type:"shape",prefix:"icon"},effects:!0,clone:!0,backdrop:!0,keyboard:!0,close:{trigger:this.close,text:"Ã—",icon:"m20 4-8 8 8 8-8-8-8 8 8-8-8-8 8 8 8-8Z",viewBox:"0 0 24 24"},locale:{close:"Close"},onOpen:()=>{},onClose:()=>{},onShow:()=>{},onHide:()=>{},onContent:()=>{},onInit:()=>{},onResume:()=>{}}}binds(){this.open=this.wrap(this.open),this.close=this.wrap(this.close),this.backdrop=this.wrap(this.backdrop),this.keyboard=this.wrap(this.keyboard)}constructor(){super(...arguments)}init(t){const e=this.element;if(!e)return;this.layout();const s=this.$=this.content(e);this.stage.append(s),this.options.onInit.call(this,this,t)}resume(t){this.options.onResume.call(this,this,t)}layout(){const t=this.options,e=this.modal=this.data({onclick:!1}),s=this.modal.$=this.compo(!!t.dialog&&"dialog",!1,{className:"object"==typeof t.className?Object.values(t.className).join(" "):t.className,hidden:!0,onclick:function(){e.onclick&&"function"==typeof e.onclick&&e.onclick.apply(this,arguments)}}),n=this.modal.body=this.compo(!1,"body"),o=this.stage=this.compo(!1,"stage"),i=this.nav=this.data(!0),r="close",{close:l,icons:c,locale:h}=t,a=i[r]=this.compo("button",["button",r],{onclick:l.trigger,innerText:"text"==c.type?l.text:"",ariaLabel:h.close});if("text"!=c.type){const{type:t,prefix:e,src:s,viewBox:n}=c,{icon:o,viewBox:i}=l,h=this.icon(t,"font"==t?o:r,e,s??o,o??r,i??n),d=h.first;d.setAttr("stroke","currentColor"),d.setAttr("stroke-width","2px"),a.append(h)}n.append(o),n.append(a),s.append(n),t.window&&s.classList.add(`${t.ns}-window`),t.backdrop&&(s.classList.add(`${t.ns}-backdrop`),e.onclick=this.backdrop),t.effects&&s.classList.add(`${t.ns}-effects`),this.root=this.selector(t.root),this.built=!0}content(t,e){const s=this.options,n=this.compo(!1,"content");let o=(e=e??s.clone)?this.cloneNode(t,!0):t;return s.onContent.call(this,this,n,o),o&&n.fill(o),n}open(t,e){if(this.event().prevent(t),this.opened)return;const s=this.options;this.built?this.resume(e):this.init(e),this.opened=!0,s.onOpen.call(this,this,e,t),this.show(e),s.keyboard&&this.event("keydown").add(this.keyboard),this.event().blur(t)}close(t,e){if(this.event().prevent(t),!this.opened)return;const s=this.options;this.opened=!1,s.onClose.call(this,this,e,t),this.hide(e),s.keyboard&&this.event("keydown").remove(this.keyboard),this.event().blur(t)}show(t){const{options:e,root:s}=this,n=this.modal.$,o=n.ns,i=n[o],r=this;n.bind(s),this.target=t,this.delay((()=>{if(e.dialog)try{e.modal?i.showModal():i.show(),i.focus()}catch(t){n.setAttr("open","")}else{const t=this.selector("button",i);t&&(t.focus(),t.blur())}n.show(),e.onShow.call(r,r,t)}))}hide(t){const{options:e,root:s}=this,n=this.modal.$,o=n.ns,i=n[o],r=this;if(n.hide(),e.dialog)try{i.close()}catch(t){n.delAttr("open")}else this.target&&this.target.focus();const l=document;l.hasFocus()&&l.activeElement.blur(),this.delay((()=>{n.unbind(s),e.onHide.call(r,r,t)}),n,300)}backdrop(t){const e=this.options,s=t.target,n=new RegExp(`${e.ns}-backdrop`);(n.test(s.className)||n.test(s.parentElement.className))&&this.close(t)}keyboard(t){if(27===t.keyCode)this.close(t)}}}(this.ensemble=this.ensemble||{});