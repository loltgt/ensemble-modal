/*!
 * ensemble Modal
 * @version 0.0.4
 * @link https://github.com/loltgt/ensemble-modal
 * @copyright Copyright (C) Leonardo Laureti
 * @license MIT License
 */
!function(t){"use strict";const e="undefined"==typeof Symbol?0:Symbol,s=/html|head|body|meta|link|style|script/i,n=/(<(html|head|body|meta|link|style|script)*>)/i;class _composition{_render(){delete this._element,delete this._render}bound(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.appendChild(s)}unbound(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.removeChild(s)}overlap(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.replaceWith(s)}append(t){const e=this.ns;return!!this[e].appendChild(t[e])}prepend(t){const e=this.ns;return!!this[e].prependChild(t[e])}remove(t){const e=this.ns;return!!this[e].removeChild(t[e])}fill(t){if(t instanceof Element==0||s.test(t.tagName)||n.test(t.innerHTML))throw new Error("Object cannot be resolved into a valid node.");const e=this[this.ns];return this.empty(),!!e.appendChild(t)}empty(){for(;this.first;)this.remove(this.first)}get children(){const t=this[this.ns];return Array.prototype.map.call(t.children,(t=>t.__compo))}get first(){const t=this[this.ns];return t.firstElementChild?t.firstElementChild.__compo:null}get last(){const t=this[this.ns];return t.lastElementChild?t.lastElementChild.__compo:null}}const o=/html|head|body|meta|link|style|script/i,i=/attributes|classList|innerHTML|outerHTML|nodeName|nodeType/;class Compo extends _composition{constructor(t,e,s,n,r,a){if(!new.target)throw"Bad invocation. Must be called with `new`.";super();const h=this.ns="_"+t,l=e?e.toString():"div";if(o.test(l))throw new Error("Provided tag name is not a valid name.");const c=this[h]=this._element(t,l,s,n,r,a);if(this.__Compo=!0,this[h].__compo=this,n&&"object"==typeof n)for(const e in n){const s=e.toString();if(i.test(s))throw new Error("Provided property name is not a valid name.");if(0===s.indexOf("on")&&n[s]&&"function"==typeof n[s])c[s]=n[s].bind(this);else if("object"!=typeof n[s])c[s]=n[s];else if("children"==s&&"object"==typeof n[s]&&n[s].length)for(const e of n.children){const s=e.tag,n=e.name,o=e.props;this.append(new Compo(t,s,n,o))}}if(s){const e=c.className;c.className="","string"==typeof s?c.className=t+"-"+s:"object"==typeof s&&(c.className=s.map((e=>t+"-"+e)).join(" ")),e&&(c.className+=" "+e)}this._render()}_element(t,e,s,n,o,i){return i?document.createElementNS(e,[...i,...o]):document.createElement(e,o)}hasAttr(t){return this[this.ns].hasAttribute(t)}getAttr(t){return this[this.ns].getAttribute(t)}setAttr(t,e){this[this.ns].setAttribute(t,e)}delAttr(t){this[this.ns].removeAttribute(t)}getStyle(t){const e=this[this.ns];return window.getComputedStyle(e)[t]}show(){this[this.ns].hidden=!1}hide(){this[this.ns].hidden=!0}enable(){this[this.ns].disabled=!1}disable(){this[this.ns].disabled=!0}get node(){return this[this.ns]}get parent(){const t=this[this.ns];return t.parentElement&&"__compo"in t.parentElement?t.parentElement.__compo:null}get previous(){const t=this[this.ns];return t.previousElementSibling?t.previousElementSibling.__compo:null}get next(){const t=this[this.ns];return t.nextElementSibling?t.nextElementSibling.__compo:null}get classList(){return this[this.ns].classList}static isCompo(t){return e?e.for(t)===e.for(Compo.prototype):t&&"object"==typeof t&&"__Compo"in t}get[e.toStringTag](){return"ensemble.Compo"}}class Data{constructor(t,e){if(!new.target)throw"Bad invocation. Must be called with `new`.";e&&"object"==typeof e&&Object.assign(this,{},e);const s=this.ns="_"+t;this.__Data=!0,this[s]={ns:t}}compo(t,e,s,n=!1,o=!1,i=!1){const r=this[this.ns].ns;let a;return a=n?{ns:r,tag:t,name:e,props:s,fresh:o,stale:i}:new Compo(r,t,e,s),o&&"function"==typeof o&&(a.fresh=s.onfresh=o),i&&"function"==typeof i&&(a.stale=s.onstale=i),a}async render(t){const e=this[this.ns],s=this;e[t]&&e[t].rendered||(e[t]={rendered:!0,fresh:s[t].fresh,stale:s[t].stale,params:s[t]},s[t]=new Compo(s[t].ns,s[t].tag,s[t].name,s[t].props)),e[t].fresh()}async stale(t){const e=this[this.ns];e[t]&&e[t].rendered&&e[t].stale()}async reflow(t,e){const s=this[this.ns];e?s[t]=this.compo(s[t].params.ns,s[t].params.name,s[t].params.props):s[t]&&s[t].rendered&&s[t].fresh()}static isData(t){return e?e.for(t)===e.for(Data.prototype):t&&"object"==typeof t&&"__Data"in t}get[e.toStringTag](){return"ensemble.Data"}}class Event{constructor(t,e,s){if(!new.target)throw"Bad invocation. Must be called with `new`.";const n=this.ns="_"+t;s=(Compo.isCompo(s)?s.node:s)||document,this.__Event=!0,this[n]={name:e,node:s}}add(t,e=!1){const s=this[this.ns],n=s.node,o=s.name;n.addEventListener(o,t,e)}remove(t){const e=this[this.ns],s=e.node,n=e.name;s.removeEventListener(n,t)}static isEvent(t){return e?e.for(t)===e.for(Event.prototype):t&&"object"==typeof t&&"__Event"in t}get[e.toStringTag](){return"ensemble.Event"}}class base{constructor(){let t,e;if(arguments.length>1?(t=arguments[0],e=arguments[1]):e=arguments[0],e&&"object"!=typeof e)throw new TypeError('Passed argument "options" is not an Object.');if(t&&"object"!=typeof t)throw new TypeError('Passed argument "element" is not an Object.');this._bindings(),this.options=this.defaults(this._defaults(),e),Object.freeze(this.options),this.element=t}defaults(t,e){const s={};for(const n in t)null!=t[n]&&"object"==typeof t[n]?s[n]=Object.assign(t[n],e[n]):s[n]=void 0!==e[n]?e[n]:t[n];return s}compo(t,e,s){const n=this.options.ns;return null!=t?new Compo(n,t,e,s):Compo}data(t){const e=this.options.ns;return null!=t?new Data(e,t):Data}event(t,e){return"string"==typeof t?new Event(this.options.ns,t,e):t?(t.preventDefault(),void t.target.blur()):Event}selector(t,e,s=!1){return e=e||document,s?e.querySelectorAll(t):e.querySelector(t)}appendNode(t,e){return!!t.appendChild(e)}prependNode(t,e){return!!t.prependChild(e)}removeNode(t,e){return!!t.removeChild(e)}cloneNode(t,e=!1){return t.cloneNode(e)}hasAttr(t,e){return t.hasAttribute(e)}getAttr(t,e){return t.getAttribute(e)}setAttr(t,e,s){t.setAttribute(e,s)}delAttr(t,e){t.removeAttribute(e)}getTime(t,e="transitionDuration"){let s=Compo.isCompo(t)?t.getStyle(e):window.getComputedStyle(t)[e];return s&&(s=s.indexOf("s")?1e3*parseFloat(s):parseInt(s)),s||0}binds(t){const e=this;return function(s){t.call(e,s,this)}}delay(t,e,s){const n=e?this.getTime(e):0;setTimeout(t,n||s)}}t.Modal=class Modal extends base{_defaults(){return{ns:"modal",root:"body",className:"modal",effects:!0,windowed:!1,clone:!0,backdrop:!0,keyboard:!0,close:{onclick:this.close,innerText:"Ã—",ariaLabel:"Close"},onOpen:function(){},onClose:function(){},onShow:function(){},onHide:function(){},onContent:function(){}}}_bindings(){this.open=this.binds(this.open),this.close=this.binds(this.close),this.backdrop=this.binds(this.backdrop),this.keyboard=this.binds(this.keyboard)}constructor(){if(!new.target)throw"Bad invocation. Must be called with `new`.";super(...arguments)}generator(){const t=this.options,e=this.modal=this.data({onclick:!1}),s=this.modal.wrap=this.compo("dialog",!1,{className:"object"==typeof t.className?t.className.join(" "):t.className,hidden:!0,onclick:function(){e.onclick&&"function"==typeof e.onclick&&e.onclick.apply(this,arguments)}}),n=this.frame=this.compo(!1,"content"),o=this.compo("button",["button","close"],t.close);s.append(n),t.windowed?(s.classList.add(t.ns+"-windowed"),n.append(o)):s.append(o),t.backdrop&&(e.onclick=this.backdrop),t.effects&&s.classList.add(t.ns+"-effects"),this.root=this.selector(t.root),this.built=!0}populate(t){const e=this.element;if(!e)return;const s=this.content(e);this.frame.append(s)}resume(t){}content(t,e){const s=this.options,n=this.compo(!1,"object");let o=(e=void 0!==e?e:s.clone)?this.cloneNode(t,!0):t;return s.onContent.call(this,this,n,o),o&&n.fill(o),n}destroy(){const t=this.root,e=this.modal.wrap;this.removeNode(t,e),this.built=!1}open(t,e){if(this.event(t),this.opened)return;const s=this.options;this.built?this.resume(e):(this.generator(),this.populate(e)),this.opened=!0,s.onOpen.call(this,this,e,t),this.show(e),s.keyboard&&this.event("keydown").add(this.keyboard)}close(t,e){if(this.event(t),!this.opened)return;const s=this.options;this.opened=!1,s.onClose.call(this,this,e,t),this.hide(e),s.keyboard&&this.event("keydown").remove(this.keyboard)}show(t){const e=this.options,s=this.root;this.modal;const n=this.modal.wrap;n.bound(s),this.delay((function(){n.show(),e.onShow.call(self,self,t)}))}hide(t){const e=this.options,s=this.root;this.modal;const n=this.modal.wrap;n.hide(),this.delay((function(){n.unbound(s),e.onHide.call(self,self,t)}),n,300)}backdrop(t){this.event(t);const e=t.target,s=e.parentElement,n=this.options.ns;var o;if(((o=new RegExp(n+"-content")).test(e.className)||o.test(s.className))&&this.close(t),!(o=new RegExp(n+"-object")).test(e.className))return;const i=e.firstElementChild,r=i.offsetWidth,a=i.offsetHeight,h=e.offsetTop,l=e.offsetLeft,c=e.offsetWidth,d=e.offsetHeight,p=t.x,m=t.y,u=(d-a)/2,f=(c-r)/2;(m>h||p>l||p<c||m<d)&&(m<u||p>f+r||m>u+a||p<f)&&this.close(t)}keyboard(t){if(this.event(t),27===t.keyCode)this.close(t)}}}(this.ensemble=this.ensemble||{});